{
    "contents" : "---\n        title: \"Reproducible Research: Peer Assessment 1\"\noutput: \n        html_document:\n        keep_md: true\n---\n        \n        ## Loading and preprocessing the data\n        This process assumes that the zip-file is located in the working directory of R\n```{r unzipandload,echo=TRUE}\ndata <- read.csv(unzip(\"activity.zip\",\"activity.csv\"))\n```\n\n## What is mean total number of steps taken per day?\nTo calculate this we first create a vector with number of steps totalled per day\n```{r meanandmedian,echo=TRUE}\nstepspd <- tapply(data$steps,data$date,FUN=sum)\n```\nBelow is a histogram of the total number of steps taken per day\n```{r histogram,fig.height=4,echo=TRUE}\npar(mar=c(5,4,1,1),las=1)\nhist(stepspd,main=\"histogram of steps per day\",xlab=\"Steps per day\")\n```\n```{r meanmedian,echo=TRUE}\nmeansteps <- as.integer(mean(stepspd,na.rm=TRUE))\nmediansteps <- as.integer(mean(stepspd,na.rm=TRUE))\n```\n\nThe mean of the number of steps per day is `r meansteps`\nThe median of the number of steps per day is `r mediansteps`\n\n## What is the average daily activity pattern?\n\nFirst we need to calculate the average nummber of steps per interval across all days and add the interval identifier, then combine them into a table and plot it.\n\n```{r pattern,echo=TRUE}\navgstepspint <- tapply(data$steps,data$interval,FUN=mean,na.rm=TRUE)\nInterv  <- unique(data$interval)\nmeanstepspint <- as.data.frame(cbind(avgstepspint,Interv))\npar(mar=c(5,4,2,1),las=1)\nplot(Interv,avgstepspint,type=\"l\",main=\"Average activity pattern\",xlab=\"Interval\",ylab=\"Avg. nmbr of steps per interval\")\n```\n\nTo determine the interval with the maximum average number of steps, this code is used:\n        ```{r maxi,echo-TRUE}\nmaxint <- which.max(avgstepspint)\ninterval <- Interv[maxint]\n```\n\nThe interval which contains the maximum number of steps is `r interval`\n\n## Imputing missing values\n```{r missing,echo=TRUE}\nincomplete <- data[!complete.cases(data),]\nnbrmissing <- nrow(incomplete)\n```\nThe number of observations with missing data is `r nbrmissing`\n\nA new data set \"data2\"is created which has its missing values imputed.\nMissing values for steps per interval are replaced with the mean number of steps for that particular interval across all days.\n\n```{r impute,echo=TRUE}\ndata2 <- data\nfor(i in 1:nrow(data2)){\n        if(is.na(data2$steps[i])){\n                data2$steps[i] <- meanstepspint$avgstepspint[match(data2$interval[i],meanstepspint$Interv)]\n        }\n}\nrm(i)\n```\n\nTo see if there is a difference between the \"raw\" data and the data with imputed values for NA's, we calculate the mean, median and histogram for the imputed data set.\n\n```{r meanandmedian2,echo=TRUE}\nstepspd2 <- tapply(data2$steps,data2$date,FUN=sum)\nmeansteps2 <- mean(stepspd2,na.rm=TRUE)\nmediansteps2 <- median(stepspd2,na.rm=TRUE)\n```\nBelow is a histogram of the total number of steps taken per day\n```{r histogram2,fig.height=4,echo=TRUE}\npar(mar=c(5,4,1,1),las=1)\nhist(stepspd2,main=\"histogram of steps per day imputed\",xlab=\"steps per day\")\n```\n\n```{r numbers,echo=TRUE}\nmeansteps2 <- as.integer(mean(stepspd2,na.rm=TRUE))\nmediansteps2 <- as.integer(median(stepspd2,na.rm=TRUE))\n```\n\nThe mean of the number of steps per day after imputation is `r meansteps2`\nThe median of the number of steps per day after imputation is `r mediansteps2`\n\nThe difference of mean, median and histogram of number of steps before and after imputation of NA values of \"steps\" can be neglected, therefore imputing data for missing values in this case does not have any impact. \n\n## Are there differences in activity patterns between weekdays and weekends?\nTo see a difference between weekdays and weekend, we must first transform the \"date\" column of data2 to a \"date\" class and then add a factor column indicating weekday or weekend per observation.\n\n```{r weekday,echo=TRUE}\ndata2$date <- as.Date(data2$date)\ndata2$day <- as.factor(weekdays(data2$date))\ndata2$weekdays <- as.factor(data2$weekdays)\n\nfor(i in 1:nrow(data2)){\nif(data2$day[i] ==\"maandag\"){data2$weekdays[i] <- \"weekday\"}\nelse if (data2$day[i]==\"dinsdag\"){data2$weekdays[i] <- \"weekday\"}\nelse if (data2$day[i]==\"woensdag\"){data2$weekdays[i] <- \"weekday\"}\nelse if (data2$day[i]==\"donderdag\"){data2$weekdays[i] <- \"weekday\"}\nelse if (data2$day[i]==\"vrijdag\"){data2$weekdays[i] <- \"weekday\"}\nelse {data$weekdays[i] <- \"weekend\"}\n}\nrm(i)\n```\n\n",
    "created" : 1442783741647.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2534409886",
    "id" : "3F87AA10",
    "lastKnownWriteTime" : 1442783765,
    "path" : "~/Opleiding/RepData_PeerAssessment1/TestpadScript.R",
    "project_path" : "TestpadScript.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}