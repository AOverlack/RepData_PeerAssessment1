data2 <- data
for(i in seq_along(data2)){
if(data2$steps==NA){
data2$steps <- meanstepspint$avgstepspint[match(data2$interval,meanstepspint$Interv)]
}
}
data2 <- data
for(seq_along(data2)){
if(data2$steps==NA){
data2$steps <- meanstepspint$avgstepspint[match(data2$interval,meanstepspint$Interv)]
}
}
data2 <- data
for(i in (seq_along(data2)){
if(data2$steps==NA){
data2$steps <- meanstepspint$avgstepspint[match(data2$interval,meanstepspint$Interv)]
}
}
head(stepspd)
rm(data2)
rm(i)
head(meanstepspint)
data2 <- data
for(i in 1:nrow(data2)){
if(is.na(data2$steps[[i]])){
data2$steps[[i]] <- meanstepspint$avgstepspint[match(data2$interval[[i]],meanstepspint$Interv)]
}
}
rm(data2)
rm(i)
data2 <- data
meanstepspintdf <- as.data.frame(meanstepspint)
for(i in 1:nrow(data2)){
if(is.na(data2$steps[[i]])){
data2$steps[[i]] <- meanstepspintdf$avgstepspint[match(data2$interval[[i]],meanstepspintdf$Interv)]
}
}
type(meanstepspintdf)
class(meanstepspintdf)
View(meanstepspintdf)
rm(data2,i,meanstepspintdf)
class(meanstepspint)
class(avgstepspint)
class(avgstepspintv)
?match
class(data)
class(meanstepspint)
meanstepspintdf <- as.data.frame(meanstepspint)
class(meanstepspintdf)
str(meanstepspintdf)
str(meanstepspint)
avgstepspint <- tapply(data$steps,data$interval,FUN=mean,na.rm=TRUE)
Interv  <- unique(data$interval)
meanstepspint <- as.data.frame(cbind(avgstepspint,Interv))
plot(Interv,avgstepspint,type="l",main="Average activity pattern",xlab="Interval",ylab="Avg. nmbr of steps per interval")
class(meanstepspint)
rm(meanstepspintdf)
data2 <- data
for(i in 1:nrow(data2)){
if(is.na(data2$steps[i])){
data2$steps[i] <- meanstepspint$avgstepspint[i,][match(data2$interval[i,],meanstepspint$Interv)]
}
}
{r impute,echo=TRUE}
data2 <- data
for(i in 1:nrow(data2)){
if(is.na(data2$steps[i])){
data2$steps[i] <- meanstepspint$avgstepspint[match(data2$interval[i,],meanstepspint$Interv)]
}
}
{r impute,echo=TRUE}
data2 <- data
for(i in 1:nrow(data2)){
if(is.na(data2$steps[i])){
data2$steps[i] <- meanstepspint$avgstepspint[match(data2$interval[i],meanstepspint$Interv)]
}
}
head(data2)
tail(data2)
head(meanstepspint)
tail(meanstepspint)
nrow(meanstepspint)
rm(i)
stepspd2 <- tapply(data2$steps,data2$date,FUN=sum)
meansteps2 <- mean(stepspd2,na.rm=TRUE)
mediansteps2 <- median(stepspd2,na.rm=TRUE)
par(mar=c(5,4,1,1),las=1)
hist(stepspd2,main="histogram of steps per day")
par(mar=c(5,4,1,1),las=1)
hist(stepspd2,main="histogram of steps per day",xlab="Steps per day imputed")
meansteps
meansteps <- mean(stepspd,na.rm=TRUE)
mediansteps <- median(stepspd,na.rm=TRUE)
meansteps
meansteps2
mediansteps
mediansteps2
par(mar=c(5,4,1,1),las=1)
hist(stepspd,main="histogram of steps per day",xlab="Steps per day")
par(mar=c(5,4,1,1),las=1)
hist(stepspd,main="histogram of steps per day",xlab="Steps per day",n=100)
par(mar=c(5,4,1,1),las=1)
hist(stepspd,main="histogram of steps per day",xlab="Steps per day")
which.max(data2$steps)
data2$steps[16492]
data$interval[16492]
data[600:620,]
data2[600:620,]
data[16492,]
str(data2)
head(data2)
data2[100:110,]
20000*2
12/44
?weekday
?weekdays
data3 <- data2
data3$weekday <- weekdays(data3$date)
as.date
data3$date <- as.Date(data3$date)
class(data3$date)
data3$weekdays <- weekdays(data3$date)
head(data3)
tail(data3)
days <- c("maandag", "dinsdag", "woensdag", "donderdag","vrijdag")
days <- c("maandag", "dinsdag", "woensdag", "donderdag","vrijdag","zaterdag","zondag")
work <- c("workday","workday","workday","workday","workday","weekend","weekend")
reftable <- as.data.frame(cbind(days,work)
)
reftable
data2$date <- as.Date(data2$date)
data2$weekdays <- weekdays(data2$date)
for(i in 1:nrow(data2)){
data2$weekday <- reftable$work[match(data2$weekday[i],reftable$days)]
}
head(data2)
head(data3)
data2 <- data3
head(data2)
head(data3)
?as.int
?mean
mean(stepspd,na.rm=TRUE)
int(mean(stepspd,na.rm=TRUE))
Int(mean(stepspd,na.rm=TRUE))
as.integer(mean(stepspd,na.rm=TRUE)
)
avgstepspint <- tapply(data$steps,data$interval,FUN=mean,na.rm=TRUE)
Interv  <- unique(data$interval)
meanstepspint <- as.data.frame(cbind(avgstepspint,Interv))
plot(Interv,avgstepspint,type="l",main="Average activity pattern",xlab="Interval",ylab="Avg. nmbr of steps per interval")
maxint <- which.max(avgstepsint)
maxint <- which.max(avgstepspint)
interval <- Interv[maxint]
interval
data$steps[interval==835]
rm(avgstepspintv)
head(Interv)
Interv[10]
which.max(avgstepspint)
Interv[104]
interv[maxint]
Interv[maxint]
head(data2)
data2$date <- as.Date(data2$date)
data2$weekdays <- weekdays(data2$date)
for(i in 1:nrow(data2)){
data2$workday <- reftable$work[match(data2$weekday[i],reftable$days)]
}
head(data2)
head(data2)
rm(reftable)
head(data2)
head(data3)
head(data2)
head(data3)
data2 <- data3
head(data2)
for(i in 1:nrow(data3)){
if(data$weekdays [i]=="maandag"|"dinsdag"|"woensdag"|"donderdag"|"vrijdag"){
data$weekdays[i] <- "weekday"
}else{
data$weekdays[i] <- "weekend"
}
}
for(i in 1:nrow(data3)){
if(data$weekdays [i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag"){
data$weekdays[i] <- "weekday"
}else{
data$weekdays[i] <- "weekend"
}
}
for(i in 1:nrow(data3)){
if(data$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data$weekdays[i] <- "weekday"
}else{
data$weekdays[i] <- "weekend"
}
}
for(i in 1:nrow(data3)){
if(data$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data$weekdays[i] <- "weekday"
}else data$weekdays[i] <- "weekend"
}
for(i in 1:nrow(data3)){
if(data$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data$weekdays[i] <- "weekday"
}else (data$weekdays[i] <- "weekend")
}
for(i in 1:nrow(data3)){
if(data$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data$weekdays[i] <- "weekday"
}else (data$weekdays[i] <- "weekend")
for(i in 1:nrow(data3)){
if(data$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data$weekdays[i] <- "weekday"
}else (data$weekdays[i] <- "weekend")
}
for(i in 1:nrow(data3)){
if(data$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data$weekdays[i] <- "weekday"
}
else {data$weekdays[i] <- "weekend"}
}
for(i in 1:nrow(data3)){
if(data$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data$weekdays[i] <- "weekday"
}
else {data$weekdays[i] <- "weekend"}
for(i in 1:nrow(data3)){
if(data$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data$weekdays[i] <- "weekday"
}
data$weekdays[i] <- "weekend"
head(data3)
head(data)
head(data2)
rm(data,data2,data3,incomplete,meanstepspint,interv,avgstepspint,days,i,interval,maxint,meansteps,meansteps2,mediansteps,stepspd,stepspd2,work)
rm(interv,mediansteps2)
rm(Interv)
data <- read.csv(unzip("activity.zip","activity.csv"))
stepspd <- tapply(data$steps,data$date,FUN=sum)
par(mar=c(5,4,1,1),las=1)
hist(stepspd,main="histogram of steps per day",xlab="Steps per day")
meansteps <- as.integer(mean(stepspd,na.rm=TRUE))
mediansteps <- as.integer(mean(stepspd,na.rm=TRUE))
avgstepspint <- tapply(data$steps,data$interval,FUN=mean,na.rm=TRUE)
Interv  <- unique(data$interval)
meanstepspint <- as.data.frame(cbind(avgstepspint,Interv))
par(mar=c(5,4,2,1),las=1)
plot(Interv,avgstepspint,type="l",main="Average activity pattern",xlab="Interval",ylab="Avg. nmbr of steps per interval")
maxint <- which.max(avgstepspint)
interval <- Interv[maxint]
incomplete <- data[!complete.cases(data),]
nbrmissing <- nrow(incomplete)
data2 <- data
for(i in 1:nrow(data2)){
if(is.na(data2$steps[i])){
data2$steps[i] <- meanstepspint$avgstepspint[match(data2$interval[i],meanstepspint$Interv)]
}
}
stepspd2 <- tapply(data2$steps,data2$date,FUN=sum)
meansteps2 <- mean(stepspd2,na.rm=TRUE)
mediansteps2 <- median(stepspd2,na.rm=TRUE)
par(mar=c(5,4,1,1),las=1)
hist(stepspd2,main="histogram of steps per day imputed",xlab="steps per day")
meansteps2 <- as.integer(mean(stepspd2,na.rm=TRUE))
mediansteps2 <- as.integer(median(stepspd2,na.rm=TRUE))
for(i in 1:nrow(data2)){
if(data2$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data2$weekdays[i] <- "weekday"
}
data2$weekdays[i] <- "weekend"
head(data2)
data2 <- data
for(i in 1:nrow(data2)){
if(is.na(data2$steps[i])){
data2$steps[i] <- meanstepspint$avgstepspint[match(data2$interval[i],meanstepspint$Interv)]
}
}
head(data2)
data2$data <- as.Date(data2$date)
data2$day <- weekdays(data2$date)
class(data2$date)
data2$date <- as.Date(data2$date)
class(data2$date)
head(data2)
rm(data2$data)
data2 <- data
for(i in 1:nrow(data2)){
if(is.na(data2$steps[i])){
data2$steps[i] <- meanstepspint$avgstepspint[match(data2$interval[i],meanstepspint$Interv)]
}
}
head(data2)
data2$date <- as.Date(data2$date)
data2$day <- weekdays(data2$date)
for(i in 1:nrow(data2)){
if(data2$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data2$weekdays[i] <- "weekday"
}
data2$weekdays[i] <- "weekend"
for(i= 1:nrow(data2)){
if(data2$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data2$weekdays[i] <- "weekday"
}
data2$weekdays[i] <- "weekend"
for(i in 1:nrow(data2)){
if(data2$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data2$weekdays[i] <- "weekday"
}
data2$weekdays[i] <- "weekend" }
for(i seq_along(data2){
if(data2$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data2$weekdays[i] <- "weekday"
}
data2$weekdays[i] <- "weekend" }
for(i seq_along(data2){
if(data2$weekdays[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data2$weekdays[i] <- "weekday"
}
data2$weekdays[i] <- "weekend"
head(data2)
for(i seq_along(data2){
if(data2$day[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data2$weekdays[i] <- "weekday"
}
data2$weekdays[i] <- "weekend"
head(data2)
for(i seq_along(data2){
if(data2$day[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag")){
data2$weekdays[i] <- "weekday"
}
data2$weekdays[i] <- "weekend"
}
for(i seq_along(data2){
if(data2$day[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag"){
data2$weekdays[i] <- "weekday"
}
data2$weekdays[i] <- "weekend"
}
data2$weekdays[i] <- "weekend"
head(data2)
for(i in 1:nrow(data2)){
if(data2$day[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag"){
data2$weekdays[i] <- "weekday"
}
data2$weekdays[i] <- "weekend"
for(i in 1:nrow(data2){
if(data2$day[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag"){
data2$weekdays[i] <- "weekday"
}
data2$weekdays[i] <- "weekend"
rm(i)
for(i in 1:nrow(data2){
if(data2$day[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag"){
data2$weekdays[i] <- "weekday"
}
data2$weekdays[i] <- "weekend"
for(i in 1:nrow(data2)){
if(data2$day[i] in c("maandag","dinsdag","woensdag","donderdag","vrijdag"){
data2$weekdays[i] <- "weekday"
}
data2$weekdays[i] <- "weekend"
head(data2)
for(i in 1:nrow(data2)){
if(data2day =="maandag"){weekdays <- "weekday"}
}
for(i in 1:nrow(data2)){
if(data$day =="maandag"){weekdays <- "weekday"}
}
for(i in 1:nrow(data2)){
if(data2$day =="maandag"){weekdays <- "weekday"}
}
head(data2)
data2 <- data
for(i in 1:nrow(data2)){
if(is.na(data2$steps[i])){
data2$steps[i] <- meanstepspint$avgstepspint[match(data2$interval[i],meanstepspint$Interv)]
}
}
rm(i)
head(data2)
stepspd2 <- tapply(data2$steps,data2$date,FUN=sum)
meansteps2 <- mean(stepspd2,na.rm=TRUE)
mediansteps2 <- median(stepspd2,na.rm=TRUE)
par(mar=c(5,4,1,1),las=1)
hist(stepspd2,main="histogram of steps per day imputed",xlab="steps per day")
meansteps2 <- as.integer(mean(stepspd2,na.rm=TRUE))
mediansteps2 <- as.integer(median(stepspd2,na.rm=TRUE))
for(i in 1:nrow(data2)){
if(data2$day[i] =="maandag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="dinsdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="woensdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="donderdag"){data2$weekdays[i] <- "weekday"}
else if data2$day[i]=="vrijdag"){data2$weekdays[i] <- "weekday"}
else {data$weekdays[i] <- "weekend"}
}
for(i in 1:nrow(data2)){
if(data2$day[i] =="maandag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="dinsdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="woensdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="donderdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="vrijdag"){data2$weekdays[i] <- "weekday"}
data$weekdays[i] <- "weekend"
}
for(i in 1:nrow(data2)){
if(data2$day[i] =="maandag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="dinsdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="woensdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="donderdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="vrijdag"){data2$weekdays[i] <- "weekday"}
data$weekdays[i] <- "weekend"
}
head(data2)
data2$date <- as.Date(data2$date)
data2$day <- weekdays(data2$date)
for(i in 1:nrow(data2)){
if(data2$day[i] =="maandag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="dinsdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="woensdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="donderdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="vrijdag"){data2$weekdays[i] <- "weekday"}
data$weekdays[i] <- "weekend"
}
head(data2)
head(data2)
?summarize
weekd <- subset(data2,weekdays=="weekday")
rm(weekd)
?subset
weekd <- subset(data2,data2$weekdays=="weekday")
weeke <- subset(data2,data2$weekdays=="weekend")
for(i in 1:nrow(data2)){
if(data2$day[i] =="maandag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="dinsdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="woensdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="donderdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="vrijdag"){data2$weekdays[i] <- "weekday"}
else {data$weekdays[i] <- "weekend"}
}
weekd <- subset(data2,weekdays=="weekday")
rm(weekd,weeke)
summary(data2$weekdays)
str(data2$weekdays)
tail(data2)
str$data2
str(data2)
head(data2)
data2[500]
data2[500,]
data2$weekdays[,zondag]
sum(data2,data2$weekdays=="maandag")
summary(data2$weekdays)
data2$weekdays <- as.factor(data2$weekdays)
class(data2$weekdays)
for(i in 1:nrow(data2)){
if(data2$day[i] =="maandag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="dinsdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="woensdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="donderdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="vrijdag"){data2$weekdays[i] <- "weekday"}
else {data$weekdays[i] <- "weekend"}
}
summary(data2$weekdays)
rm(i)
for(i in 1:nrow(data2)){
if(data2$day[i] =="maandag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="dinsdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="woensdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="donderdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="vrijdag"){data2$weekdays[i] <- "weekday"}
else {data$weekdays[i] <- "weekend"}
}
summary(data2$weekdays)
class(data2$day)
data2$date <- as.Date(data2$date)
data2$day <- as.factor(weekdays(data2$date))
data2$weekdays <- as.factor(data2$weekdays)
class(data2$day)
summary(data2$day)
for(i in 1:nrow(data2)){
if(data2$day[i] =="maandag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="dinsdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="woensdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="donderdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="vrijdag"){data2$weekdays[i] <- "weekday"}
else {data$weekdays[i] <- "weekend"}
}
summary(data2$weekdays)
rm(i)
for(i in 1:nrow(data2)){
if(data2$day[i] =="maandag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="dinsdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="woensdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="donderdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="vrijdag"){data2$weekdays[i] <- "weekday"}
else {data$weekdays[i] <- "weekend"}
}
summary(data2$weekdays)
for(i in 1:nrow(data2)){
if(data2$day[i] =="maandag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="dinsdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="woensdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="donderdag"){data2$weekdays[i] <- "weekday"}
else if (data2$day[i]=="vrijdag"){data2$weekdays[i] <- "weekday"}
else {data$weekdays[i] <- "weekend"}
}
rm(i)
summary(data2$weekday)
summary(data2$weekdays)
summary(data2$weekend)
